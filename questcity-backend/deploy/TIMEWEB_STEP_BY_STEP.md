# –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ QuestCity –Ω–∞ Timeweb Cloud

## üöÄ –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ VDS —Å–µ—Ä–≤–µ—Ä–∞

### 1.1 –í—Ö–æ–¥ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
1. –û—Ç–∫—Ä–æ–π—Ç–µ [https://timeweb.cloud/](https://timeweb.cloud/)
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"–û–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã"**

### 1.2 –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
1. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–µ—Ä"**
2. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
   - **–û–°**: Ubuntu 22.04 LTS
   - **CPU**: 2 —è–¥—Ä–∞
   - **RAM**: 4 GB
   - **–î–∏—Å–∫**: 80 GB SSD
   - **–°–µ—Ç—å**: –ü—É–±–ª–∏—á–Ω–∞—è
3. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**
4. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ (2-3 –º–∏–Ω—É—Ç—ã)
5. **–ó–∞–ø–∏—à–∏—Ç–µ IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞** - –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üóÑÔ∏è –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL

### 2.1 –°–æ–∑–¥–∞–Ω–∏–µ –ë–î
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"–û–±–ª–∞—á–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"**
2. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"**
3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **–¢–∏–ø**: PostgreSQL 16
   - **CPU**: 1 —è–¥—Ä–æ
   - **RAM**: 2 GB
   - **–î–∏—Å–∫**: 20 GB
   - **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–∫–ª—é—á–∏—Ç—å
4. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**

### 2.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î
1. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ë–î –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –µ—ë –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
2. –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
   - **–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: `questcity_user`
   - **–ü–∞—Ä–æ–ª—å**: —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å
3. **–ó–∞–ø–∏—à–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**:
   - –•–æ—Å—Ç –ë–î
   - –ü–æ—Ä—Ç (–æ–±—ã—á–Ω–æ 5432)
   - –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å

## üì¶ –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

### 3.1 –°–æ–∑–¥–∞–Ω–∏–µ bucket
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"–û–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ"**
2. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å bucket"**
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ:
   - **–ò–º—è**: `questcity-storage`
   - **–†–µ–≥–∏–æ–Ω**: ru-1
   - **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–∫–ª—é—á–∏—Ç—å
4. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**

### 3.2 –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"API –∫–ª—é—á–∏"** –≤ —Ä–∞–∑–¥–µ–ª–µ S3
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞
3. **–ó–∞–ø–∏—à–∏—Ç–µ**:
   - Access Key ID
   - Secret Access Key

## üîß –®–∞–≥ 4: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VDS —Å–µ—Ä–≤–µ—Ä—É

### 4.1 –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
1. –í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –≤–∞—à–µ–º—É VDS —Å–µ—Ä–≤–µ—Ä—É
2. –ù–∞–π–¥–∏—Ç–µ **IP-–∞–¥—Ä–µ—Å** —Å–µ—Ä–≤–µ—Ä–∞
3. –ù–∞–π–¥–∏—Ç–µ **–ø–∞—Ä–æ–ª—å root** (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ SSH –∫–ª—é—á)

### 4.2 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH
```bash
# Windows (PowerShell –∏–ª–∏ Git Bash)
ssh root@YOUR_SERVER_IP

# Mac/Linux
ssh root@YOUR_SERVER_IP
```

## üê≥ –®–∞–≥ 5: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
apt update && apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose
curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
docker --version
docker-compose --version
```

## üìÅ –®–∞–≥ 6: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### 6.1 –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
```bash
mkdir -p /opt/questcity
cd /opt/questcity
```

### 6.2 –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
–£ –≤–∞—Å –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:

**–í–∞—Ä–∏–∞–Ω—Ç A: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ Git (–µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)**
```bash
git clone https://github.com/your-username/questcity-backend.git
cd questcity-backend
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ SCP (–µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ)**
```bash
# –ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
scp -r questcity-backend root@YOUR_SERVER_IP:/opt/questcity/
```

**–í–∞—Ä–∏–∞–Ω—Ç C: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤—Ä—É—á–Ω—É—é**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
mkdir -p questcity-backend/src questcity-backend/deploy
cd questcity-backend
```

## ‚öôÔ∏è –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 7.1 –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
cd /opt/questcity/questcity-backend/deploy
cp env.production.example .env.production
nano .env.production
```

### 7.2 –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–ó–∞–º–µ–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ `.env.production`:

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–¥–∞–Ω–Ω—ã–µ –∏–∑ —à–∞–≥–∞ 2)
DATABASE_HOST=your-database-host.timeweb.cloud
DATABASE_USERNAME=questcity_user
DATABASE_PASSWORD=your-database-password
DATABASE_NAME=questcity_db

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ S3 (–¥–∞–Ω–Ω—ã–µ –∏–∑ —à–∞–≥–∞ 3)
S3_ACCESS_KEY=your-s3-access-key
S3_SECRET_KEY=your-s3-secret-key
S3_ENDPOINT=https://s3.timeweb.cloud
S3_BUCKET_NAME=questcity-storage

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–º–µ–Ω–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω)
APP_ALLOW_ORIGINS=["https://questcity.yourdomain.com"]

# –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π)
APP_SESSION_SECRET_KEY=your-super-secret-session-key-change-this
```

## üöÄ –®–∞–≥ 8: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 8.1 –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
```bash
cd /opt/questcity/questcity-backend
chmod +x deploy/deploy.sh
./deploy/deploy.sh
```

### 8.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
docker-compose -f docker-compose.production.yml ps
```

### 8.3 –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î
```bash
docker-compose -f docker-compose.production.yml exec questcity-backend alembic upgrade head
```

## üåê –®–∞–≥ 9: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ –∏ SSL

### 9.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS
1. –í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–∏–º –¥–æ–º–µ–Ω–æ–º –¥–æ–±–∞–≤—å—Ç–µ A-–∑–∞–ø–∏—Å—å:
   - **–ò–º—è**: `api` (–∏–ª–∏ –ø–æ–¥–¥–æ–º–µ–Ω –ø–æ –≤–∞—à–µ–º—É –≤—ã–±–æ—Ä—É)
   - **–ó–Ω–∞—á–µ–Ω–∏–µ**: IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ VDS —Å–µ—Ä–≤–µ—Ä–∞

### 9.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL
```bash
cd /opt/questcity/questcity-backend
chmod +x deploy/setup-ssl.sh
./deploy/setup-ssl.sh api.questcity.yourdomain.com
```

## üîí –®–∞–≥ 10: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 10.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ UFW
apt install ufw

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª
ufw default deny incoming
ufw default allow outgoing
ufw allow ssh
ufw allow 80
ufw allow 443
ufw enable
```

### 10.2 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```bash
apt install unattended-upgrades
dpkg-reconfigure -plow unattended-upgrades
```

## ‚úÖ –®–∞–≥ 11: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### 11.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ API
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint
curl http://localhost:8000/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API
curl http://localhost:8000/docs
```

### 11.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- `http://YOUR_SERVER_IP:8000/docs` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- `https://api.questcity.yourdomain.com/docs` - —á–µ—Ä–µ–∑ –¥–æ–º–µ–Ω (–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL)

## üìä –®–∞–≥ 12: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### 12.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ htop
apt install htop

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ netdata (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
bash <(curl -Ss https://my-netdata.io/kickstart.sh)
```

### 12.2 –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose -f docker-compose.production.yml logs -f questcity-backend

# –õ–æ–≥–∏ Nginx
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log
```

## üÜò –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î –≤ .env.production
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ IP —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –ë–î –≤ Timeweb Cloud
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ Docker –æ–±—Ä–∞–∑–∞
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û—á–∏—Å—Ç–∏—Ç–µ Docker –∫—ç—à
docker system prune -a

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑
docker-compose -f docker-compose.production.yml build --no-cache
```

### –ü—Ä–æ–±–ª–µ–º–∞: SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DNS
nslookup api.questcity.yourdomain.com

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
certbot --nginx -d api.questcity.yourdomain.com --force-renewal
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose -f docker-compose.production.yml logs`
2. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É Timeweb Cloud —á–µ—Ä–µ–∑ —á–∞—Ç –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤ Timeweb Cloud

## üéâ –ì–æ—Ç–æ–≤–æ!

–í–∞—à QuestCity Backend —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ Timeweb Cloud!

**–î–æ—Å—Ç—É–ø–Ω—ã–µ URL:**
- API: `https://api.questcity.yourdomain.com`
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `https://api.questcity.yourdomain.com/docs`
- Health check: `https://api.questcity.yourdomain.com/health`



