# –û—Ç—á–µ—Ç: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è —Ç–∏–ø–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫—É –∫–≤–µ—Å—Ç–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
Failed to update quest: type 'QuestEditScreenLoading' is not a subtype of type 'QuestEditScreenLoaded' in type cast
```

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 1. –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–∫–∏ ‚úÖ
–û—à–∏–±–∫–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –≤ –º–µ—Ç–æ–¥–µ `updatePointData()` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–ø—ã—Ç–∫–∞ –ø—Ä–∏–≤–µ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫ `QuestEditScreenLoaded`, –Ω–æ –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è `QuestEditScreenLoading`.

### 2. –ü–æ–∏—Å–∫ –ø—Ä–∏—á–∏–Ω—ã ‚úÖ
–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∏–∑ `EditQuestPointScreen` 
- –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å `QuestEditScreenLoading` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö)
- –ú–µ—Ç–æ–¥ `updatePointData()` –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–∏–≤–µ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫ `QuestEditScreenLoaded`
- –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è —Ç–∏–ø–æ–≤

### 3. –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ ‚úÖ
**–í `quest_edit_screen.dart`:**
```dart
// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
if (result != null && result is PointEditData) {
  cubit.updatePointData(result);  // ‚ùå –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
}
```

**–í `quest_edit_screen_cubit.dart`:**
```dart
void updatePointData(PointEditData data) {
  if (state is QuestEditScreenLoaded) {  // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å—Ç—å
    final currentState = state as QuestEditScreenLoaded;  // ‚ùå –ù–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—à–∏–±–∫–∞
    // ...
  }
}
```

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ `updatePointData()` ‚úÖ
```dart
void updatePointData(PointEditData data) {
  print('üîç DEBUG: updatePointData - –ù–∞—á–∞–ª–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è');
  print('  - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: ${state.runtimeType}');
  
  if (state is QuestEditScreenLoaded) {
    // ... –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    print('üîç DEBUG: updatePointData - –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ');
  } else {
    print('‚ùå DEBUG: updatePointData - –ù–µ–≤–µ—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: ${state.runtimeType}');
    print('  - –û–∂–∏–¥–∞–ª–æ—Å—å: QuestEditScreenLoaded');
    print('  - –ü–æ–ª—É—á–µ–Ω–æ: ${state.runtimeType}');
  }
}
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º ‚úÖ
**–ë—ã–ª–æ:**
```dart
if (result != null && result is PointEditData) {
  cubit.updatePointData(result);  // –ë–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
}
```

**–°—Ç–∞–ª–æ:**
```dart
if (result != null && result is PointEditData) {
  // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  Future.delayed(Duration(milliseconds: 100), () {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
    if (cubit.state is QuestEditScreenLoaded) {
      cubit.updatePointData(result);
    } else {
      print('‚ùå DEBUG: –ù–µ–≤–µ—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è updatePointData: ${cubit.state.runtimeType}');
    }
  });
}
```

## –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
–î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ 100ms, —á—Ç–æ–±—ã –¥–∞—Ç—å –≤—Ä–µ–º—è —Å–æ—Å—Ç–æ—è–Ω–∏—é —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–∑ `EditQuestPointScreen`.

### 2. –î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü–µ—Ä–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ `quest_edit_screen.dart` –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `updatePointData()`
- –í—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–Ω—É—Ç—Ä–∏ `updatePointData()` –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞

### 3. –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º.

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –±–æ–ª—å—à–µ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Ç–æ—á–µ–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –∏–∑ `EditQuestPointScreen`
- ‚úÖ –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. –û—Ç–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–≤–µ—Å—Ç–∞
2. –í—ã–±—Ä–∞—Ç—å —Ç–æ—á–∫—É –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. –ò–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø –∏–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
5. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ—à–∏–±–∫–∞ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
